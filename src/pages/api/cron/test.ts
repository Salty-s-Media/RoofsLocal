const resend = new Resend(process.env.RESEND_API_KEY);

export default async function handler(req: NextApiRequest, res: NextApiResponse) {
    resend.emails.send({
        from: "Roofs Local <info@roofslocal.app>", // TODO: Change for production
        to: ['richardcong635@gmail.com'],
        subject: "Leads",
        text: `Attached are david.nye@goskymark.com's leads: 1 for zip codes 32757,33710,33711,33712,33715,33601,33546,33548,33549,33556,33558,33559,33564,33565,33568,33576,33580,33593,33596,34610,34611,34613,34614,34615,34616,34618,34619,34621,34622,34624,34625,34627,34628,34629,34630,34631,34632,34634,34635,34637,34638,34639,34652,34653,34654,34655,34656,34657,34658,34659,34660,34661,34662,34663,34667,34668,34669,34673,34674,34677,34679,34680,34681,34683,34684,34685,34690,34691,34692,34693,34695,34698,33510,33511,33512,33513,33514,33515,33516,33518,33520,33521,33523,33524,33525,33526,33527,33529,33530,33534,33535,33537,33539,33540,33541,33542,33543,33544,33545,33546,33547,33548,33549,33556,33563,33564,33565,33566,33567,33569,33570,33571,33572,33573,33574,33575,33576,33578,33579,33584,33585,33586,33592,33594,33602,33603,33604,33605,33606,33607,33608,33609,33610,33611,33612,33613,33614,33615,33616,33617,33618,33619,33620,33621,33622,33623,33624,33625,33626,33629,33630,33631,33634,33635,33637,33647,33650,34231,34230,34201,34202,34203,34204,34205,34206,34207,34208,34209,34210,34211,34212,34219,34221,34222,34223,34224,34229,34232,34233,34234,34235,34236,34237,34238,34239,34240,34241,34242,34243,34251,34260,34264,34266,34268,34269,34270,34276,34277,34278,34280,34281,34282,34284,34285,34286,34287,34288,34289,34290,34293,34295,33655,33664,33672,33673,33674,33675,33677,33679,33680,33681,33682,33684,33685,33686,33687,33688,33689,33694,34228,34249,34275,34291,34292,33633,33646,33598,32124,32168,32724,32827,32832,33830,34714,34715,34762,34787. Charged 230 USD.`,
        attachments: [{
          filename: "leads.csv",
          contentType: 'text/csv',
          content: await fs.promises.readFile('/Users/rcong/Desktop/jobs/companies/saltys/RoofsLocal/src/pages/api/cron/leads.csv',, // Attach leads as CSV
        }]
    });
}